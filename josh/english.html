<html>
	<head>
		<title>JoshTalks Live</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="assets/css/basic.css">
		<link rel="stylesheet" href="assets/css/odometer-theme.css">
		<link rel="shortcut icon" type="image/png" href="assets/pics/favicon.png"/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	</head>
	<body id="page">
		<div class="vg-container vg-center"><h3 id="yt-name"></h3></div>
			<div class="vg-cell vg-mobile vg-col s12">
				<div class="vg-container vg-center"><p><img src="assets/pics/icon.png" class="vg-circle" height="60" id="eng"></p></div>
				<div class="vg-container vg-center">
					<p class="vg-col m4 s12">Subscribers: <b id="eng-subs" class="odometer">00,000,000</b></p>
					<p class="vg-col m4 s8">Views: <b id="eng-view" class="odometer">00,000,000,000</b></p>
					<p class="vg-col m4 s4">Videos: <b id="eng-vid" class="odometer">00,000</b></p>
				</div>
			</div>
		</div>
		</br>
		<div class="vg-bar">
			<button class="vg-button vg-col l8 m4 s12" onclick="theme()">THEME</button>
			<button class="vg-button vg-white vg-col l2 m4 s6" onclick="myfunc1()">Light</button>
			<button class="vg-button vg-black vg-col l2 m4 s6" onclick="myfunc2()">Dark</button>
		</div>
		<script src="assets/js/odometer.min.js"></script>
		<script>
			var x = document.getElementById("page");
			var time = new Date().getHours();
			if(time < 6){
				x.style ="color:#fff!important;background-color:#000!important";
			}else if(time < 18){
				x.style ="color:#000!important;background-color:#fff!important";
			}else{
				x.style ="color:#fff!important;background-color:#000!important";
			}
			function theme() {
				var x = document.getElementById("page");
				if(x.style="color:#fff!important;background-color:#000!important"){
					x.style ="color:#000!important;background-color:#fff!important";
					console.log("theme light");
				}else{
					x.style="color:#fff!important;background-color:#000!important";
					console.log("theme dark");
				}
			};
			function myfunc1() {
				var x = document.getElementById("page");
				if(x.style="color:#fff!important;background-color:#000!important"){
					x.style ="color:#000!important;background-color:#fff!important";
				}
			};
			function myfunc2() {
				var x = document.getElementById("page");
				if(x.style="color:#000!important;background-color:#fff!important"){
					x.style ="color:#fff!important;background-color:#000!important";
				}
			};
		</script>
		<script>
		od1 = new Odometer({
			el: document.querySelector('#eng-subs'),
			value: 0,
			format: '(,ddd).dd',
			theme: 'minimal'
		});
		od2 = new Odometer({
			el: document.querySelector('#eng-view'),
			value: 0,
			format: '(,ddd).dd',
			theme: 'minimal'
		});
		od3 = new Odometer({
			el: document.querySelector('#eng-vid'),
			value: 0,
			format: '(,ddd).dd',
			theme: 'minimal'
		});
		var YT = {};
	  YT.keyManager = {
	    keys: ["AIzaSyCirzn_euhI10MY2_Mo1gQjgult6_Rw4CY", "AIzaSyBh9NX-IZVLyk6C2nt448dYYuwmIMdPvpI", "AIzaSyBR1Fz9C-5PM1-56g6l3fc3jTNxeVioIrI", "AIzaSyDgNPwHuae7dtgwmZwhpdKDC8xYahugz-w", "AIzaSyCuXXjTVn79AENIQiJfRSYDLzeZIzZyqg4"],
	    keyIndex: 0,
	    getKey: function() {
	      this.keyIndex = (this.keyIndex + 1) % (this.keys.length);
	      return this.keys[this.keyIndex];
	    },
	    shuffleKeys: function() {
	      this.keys.shuffle();
	    },
	  }
		YT.live = {
		  countMap: {},
		  countMapV: {},
		  channelIDs: ["UCGYlNGlloLLZiAL3zBgbMgQ"/*, "UC5MaEdGrolKRJXFdXgD7RAA", "UC6KXCdfpkCGmRTgBPj9hdbQ", "UC2KhNQ3pAmkN6Kepf8ccFZQ", "UCE6Y7GPi7LG3_w0cmBFZRwA", "UCTOWKyc49SY32OYtXontXoQ", "UCHO1It3X8dB0Lfxer_4ev-A", "UCUbhtpmudp_9vfmytdcD3lQ", "UChlEKXoTTTizQN5trVkyNiQ"*/],
		  update: function() {
		    var total_count = 0;
		    var total_countV = 0;
		    var promises = [];
		    countMap = this.countMap;
		    countMapV = this.countMapV;
		    $.each(this.channelIDs, function(x, y) {
		        promises.push($.getJSON("https://www.googleapis.com/youtube/v3/channels?part=statistics&id=" + y + "&key=" + YT.keyManager.getKey()));
		    });
		    $.when(promises).done(function(a){
		      count = 0;
		      $.each(a, function(c, b){
		        b.then(function(x){
		          switch(x.items[0].id){
		            case "UCGYlNGlloLLZiAL3zBgbMgQ":
		              od1.update(x.items[0].statistics.subscriberCount);
		              od2.update(x.items[0].statistics.viewCount);
									od3.update(x.items[0].statistics.videoCount);
		            break;
		          }
		        })
		      })
		    });
		  },
		  profile: function() {
		    var total_count = 0;
		    var total_countV = 0;
		    var promises = [];
		    countMap = this.countMap;
		    countMapV = this.countMapV;
		    $.each(this.channelIDs, function(x, y) {
		        promises.push($.getJSON("https://www.googleapis.com/youtube/v3/channels?part=statistics,snippet&id=" + y + "&key=" + YT.keyManager.getKey()));
		    });
		    $.when(promises).done(function(a){
		      count = 0;
		      $.each(a, function(c, b){
		        b.then(function(x){
		          switch(x.items[0].id){
		            case "UCGYlNGlloLLZiAL3zBgbMgQ":
		              od1.update(x.items[0].statistics.subscriberCount);
		              od2.update(x.items[0].statistics.viewCount);
									od3.update(x.items[0].statistics.videoCount);
		              document.getElementById("yt-name").innerHTML=x.items[0].snippet.title;
									document.getElementById("eng").src=x.items[0].snippet.thumbnails.default.url;
		            break;
		          }
		        })
		      })
		    });
		  },
		  timer: null,
		  start: function() {
		    YT.live.profile();
		    this.timer = setInterval(function(e) {
		        YT.live.update();
		    }, 4000);
		},
		  stop: function() {
		    clearInterval(this.timer);
		}
		};

		$(function() {
		  YT.live.start();
		});
		$(document).ready(function(){
		  $(window).focus(function(){
		    console.log('started ');
		    YT.live.start();
		  });
		  $(window).blur(function(){
		    console.log('paused');
		    YT.live.stop();
		  });
		});
		</script>
	</body>
</html>
